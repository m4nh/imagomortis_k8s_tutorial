apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "imagomortis.configMapName" . }}
  namespace: {{ include "imagomortis.namespace" . }}
  labels:
    {{- include "imagomortis.labels" . | nindent 4 }}
data:
  # Database configuration
  POSTGRES_DB: {{ .Values.database.name | quote }}
  POSTGRES_HOST: {{ include "imagomortis.postgresHost" . | quote }}
  POSTGRES_PORT: {{ .Values.database.port | quote }}
  PGDATA: "/var/lib/postgresql/data/pgdata"
  
  # Uploader configuration
  UPLOADER_RESIZE_HEIGHT: {{ .Values.uploader.config.resizeHeight | quote }}
  UPLOADER_HOST: {{ .Values.uploader.config.host | quote }}
  UPLOADER_PORT: {{ .Values.uploader.config.port | quote }}
  
  # Pusher configuration
  PUSHER_POLL_INTERVAL: {{ .Values.pusher.config.pollInterval | quote }}
  
  # API configuration
  API_HOST: {{ .Values.api.config.host | quote }}
  API_PORT: {{ .Values.api.config.port | quote }}
  
  # WebUI configuration
  PUBLIC_UPLOAD_SERVICE_URL: {{ .Values.webui.config.publicUploadServiceUrl | quote }}
  PUBLIC_API_SERVICE_URL: {{ .Values.webui.config.publicApiServiceUrl | quote }}
  ORIGIN: {{ .Values.webui.config.origin | quote }}
  HOST: {{ .Values.webui.config.host | quote }}
  PORT: {{ .Values.webui.config.port | quote }}
  
  # Scheduler configuration
  SCHEDULER_POLL_INTERVAL: {{ .Values.scheduler.config.pollInterval | quote }}
  SCHEDULER_IMAGE_TASK_IMAGE: {{ include "imagomortis.imageTaskImage" . | quote }}
  SCHEDULER_SHARED_VOLUME_PATH: {{ .Values.scheduler.config.sharedVolumePath | quote }}
  SCHEDULER_SHARED_PVC_NAME: {{ include "imagomortis.schedulerPvcName" . | quote }}
